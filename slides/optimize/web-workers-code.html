<h2>Web workers - Example</h2>
<ul class="nav nav-tabs">
    <li class="active"><a class="tab-pane" data-toggle="tab" href="#worker-main">Main</a></li>
    <li><a class="tab-pane" data-toggle="tab" href="#worker-worker">Worker</a></li>
</ul>
<div class="tab-content">
    <div id="worker-main" class="tab-pane active">
<pre style="height: auto;font-size: 3rem;"><code class="js" style="height: 30em;" >var worker = new Worker('js/data-collector.js');

worker.addEventListener('message',function(event) {
    gauge.update(event.data);
},false);

worker.postMessage('start');
</code></pre>
        </div>
    <div id="worker-worker" class="tab-pane">
        <pre style="height: auto;font-size: 3rem;"><code class="js" style="height: 30em;">var ws, queue = [], maxSize = 1000;

function countAndSend(){
    var count = queue.splice(0,queue.length)
            .reduce(function (prev,d) {
                return prev+d.price
            },0);
    postMessage(count);
}

self.addEventListener('message',function (evt) {
    if (evt.data == 'start') {
        ws = new WebSocket('ws://myserver/shopping-info')
    }
    ws.onmessage = function (evt) {
        queue.push(evt.data);
        if (queue.length > maxSize) queue.shift()
    }
    setInterval(countAndSend,1000);
},false);</code></pre>
    </div>
